# 5. デバイスとLinuxファイルシステム

<ul>
    <li><a href="#5-1">5.1 パーティションとファイルシステムの作成</a></li>
    <ul>
        <li><a href="#5-1-1">5.1.1 ハードディスク</a></li>
        <li><a href="#5-1-2">5.1.2 パーティションの種類</a></li>
        <li><a href="#5-1-3">5.1.3 ルートファイルシステム</a></li>
        <li><a href="#5-1-4">5.1.4 パーティション管理コマンド</a></li>
        <li><a href="#5-1-5">5.1.5 ファイルシステムの作成</a></li>
    </ul>
    <li><a href="#5-2">5.2 ファイルシステムの管理</a></li>
    <li><a href="#5-3">5.3 ファイルシステムのマウントとアンマウント</a></li>
    <li><a href="#5-4">5.4 ディスククォータの管理</a></li>
    <li><a href="#5-5">5.5 ファイルの配置と検索</a></li>
</ul>

<div id="5-1"></div>
## 5.1 パーティションとファイルシステムの作成

<div id="5-1-1"></div>
### 5.1.1 ハードディスク

#### 接続形態の規格
- SATA(Serial ATA)
- SAS(Serial Attached SCSI)
- SCSI
- USB

#### デバイスファイル

|デバイスファイル|説明                            |
|----------------|--------------------------------|
|/dev/sda        |1番目のハードディスク           |
|/dev/sdb        |2番目のハードディスク           |
|/dev/sbc        |3番目のハードディスク           |
|/dev/sdd        |4番目のハードディスク           |
|/dev/sr0        |1番目のCD/DVDドライブ           |
|/dev/st0        |2番目のCD/DVDドライブ           |

<div id="5-1-2"></div>
### 5.1.2 パーティションの種類

#### 基本パーティション

/dev/sda1~sda4

#### 拡張パーティション

基本パーティションの1つを拡張パーティションにすることが出来る、拡張パーティションの中にはファイルシステムではなく、論理パーティションが格納される

#### 論理パーティション

拡張パーティション内に作成されたパーティションのこと。/dev/sda5移行になる 

<div id="5-1-3"></div>
### 5.1.3 ルートファイルシステム

ルートファイルシステムに必要なディレクトリ

|ディレクトリ|内容                                         |
|------------|---------------------------------------------|
|/bin, /sbin |システムに必要なコマンド、プログラム         |
|/etc        |各種設定                                     |
|/lib        |ライブラリ                                   |
|/dev        |デバイスファイル                             |

<div id="5-1-4"></div>
### 5.1.4 パーティション管理コマンド

#### fdisk

パーティションの作成、削除、変更、情報表示などを行う。

```
# fdisk -l /dev/sda
```

|サブコマンド|機能                                         |
|------------|---------------------------------------------|
|l           |パーティションのタイプを一覧表示する         |
|n           |パティションを作成する                       |
|d           |パーティションを削除する                     |
|p           |パーティションテーブルを表示する             |
|t           |パーティションのタイプを変更する             |
|a           |ブートフラグのオン・オフを切り替える         |
|w           |パーティションテーブルの変更を保存して終了する|
|q           |パーティションテーブルの変更を保存しないで終了する|
|m           |ヘルプメニューを表示する                     |

#### gdisk

GPT(GUIDパーティションテーブル)を利用した操作を行う

- GPT : 扱えるハードディスクの制限なし、128個まで作成可能
- MBR : 扱える容量は2TBまで

#### parted

MBRにもGPTにも対応したパーティション操作コマンド
一括して処理を実行することも可能

|サブコマンド|機能                                         |
|------------|---------------------------------------------|
|check 番号  |ファイルシステムの簡単なチェックを行う       |
|mklabel [gpt,msdos]|新しいパーティションテーブルを作成する|
|mkpart 種別 開始 終了 |指定した種別のパーティションを作成する|
|rm 番号     |指定したパーティションを削除する             |
|print, p    |パーティションテーブルを表示する             |
|quit, q     |終了する                                     |


<div id="5-1-5"></div>
### 5.1.5 ファイルシステムの作成

- ファイルシステム : ファイルとしてディスク上のデータを扱う仕組み
- セクタ : ディスク上の区画。1セクタ512バイト、CD-ROMで2,048バイト、媒体によって様々
- ブロック : ファイルシステムがデータを保存する単位
- iノード : ファイルの属性や管理情報

#### ファイルシステムの種類

|ファイルシステム|説明                                     |
|----------------|-----------------------------------------|
|ext2            |Linuxの標準ファイルシステム              |
|ext3            |ext2にジャーナリング機能を加えたファイルシステム|
|ext4            |ext3を機能拡張したファイルシステム       |
|ReiserFS        |高速なジャーナリングファイルシステム     |
|XFS             |SGI社が開発したジャーナリングファイルシステム|
|JFS             |IBM社が開発したジャーナリングファイルシステム|
|Btrfs           |高度な機能を備えたファイルシステム       |
|iso9660         |CD-ROMのファイルシステム                 |
|msdos           |MS-DOSのファイルシステム                 |
|vfat            |SDカードや古いWindowsで使われるファイルシステム|
|nfs             |NFS(Network File System)                 |

[Wikipedia参考](https://ja.wikipedia.org/wiki/ファイルシステム)

#### mkfs

パーティション上にファイルシステムを作成するコマンド

|オプション  |機能                                         |
|------------|---------------------------------------------|
|-t ファイルシステムタイプ |ファイルシステムの種類を指定する|
|-c          |実行前に不良ブロックを検査する               |

mkfsから呼び出されるプログラム

|ファイルシステム|プログラム|mkfsコマンドの書式                 |
|----------------|----------|-----------------------------------|
|ext2            |mkfs.ext2 |mkfs -t ext2                       |
|ext3            |mkfs.ext3 |mkfs -t ext3                       |
|ext4            |mkfs.ext4 |mkfs -t ext4                       |
|XFS             |mkfs.xfs  |mkfs -t xfs                        |
|VFAT            |mkfs.vfat |mkfs -t vfat                       |
|Btrfs           |mkfs.btrfs |mkfs -t btrfs                     |

#### mke2fs

ext2, ext3, ext4ファイルシステムを作成することが出来る

|オプション  |機能                                         |
|------------|---------------------------------------------|
|-t ファイルシステムタイプ |ファイルシステムの種類を指定する|
|-j          |ext3ファイルシステムを作成する               |
|-c          |実行前に不良ブロックを検査する               |




<p style="padding-bottom:20px;"></p>

<hr>

<p style="padding-bottom:20px;"></p>

<div id="5-2"></div>
## 5.2 ファイルシステムの管理

<p style="padding-bottom:20px;"></p>

<hr>

<p style="padding-bottom:20px;"></p>

<div id="5-3"></div>
## 5.3 ファイルシステムのマウントとアンマウント

<p style="padding-bottom:20px;"></p>

<hr>

<p style="padding-bottom:20px;"></p>

<div id="5-4"></div>
## 5.4 ディスククォータの管理

<p style="padding-bottom:20px;"></p>

<hr>

<p style="padding-bottom:20px;"></p>

<div id="5-5"></div>
## 5.5 ファイルの配置と検索
